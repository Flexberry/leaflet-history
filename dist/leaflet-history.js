/*! leaflet-history 19-03-2015 */
!function(){L.HistoryControl=L.Control.extend({options:{position:"topright",maxMovesToSave:10,useExternalControls:!1,backImage:"fa fa-caret-left",backText:"",backTooltip:"Go to Previous Extent",backImageBeforeText:!0,forwardImage:"fa fa-caret-right",forwardText:"",forwardTooltip:"Go to Next Extent",forwardImageBeforeText:!1,orientation:"horizontal",shouldSaveMoveInHistory:function(){return!0}},initialize:function(t){L.Util.setOptions(this,t),this._state.maxMovesToSave=this.options.maxMovesToSave},onAdd:function(t){this._map=t;var e=L.DomUtil.create("div","history-control leaflet-bar leaflet-control "+this.options.orientation);return this.options.useExternalControls||(this._backButton=this._createButton("back",e,this.goBack,this),this._forwardButton=this._createButton("forward",e,this.goForward,this)),this._updateDisabled(),this._addMapListeners(),e},onRemove:function(t){t.off("movestart")},performActionWithoutTriggeringEvent:function(t){var e=this._state.ignoringEvents;this._state.ignoringEvents=!0,$.isFunction(t)&&t(),this._state.ignoringEvents=e},moveWithoutTriggeringEvent:function(t){var e=this;this.performActionWithoutTriggeringEvent(function(){e._map.setView(t.centerPoint,t.zoom)})},goBack:function(){return this._invokeBackOrForward("historyback",this._state.history,this._state.future)},goForward:function(){return this._invokeBackOrForward("historyforward",this._state.future,this._state.history)},clearHistory:function(){this._state.history.items=[],this._updateDisabled()},clearFuture:function(){this._state.future.items=[],this._updateDisabled()},_map:null,_backButton:null,_forwardButton:null,_state:{backDisabled:null,forwardDisabled:null,ignoringEvents:!1,maxMovesToSave:0,history:{items:[]},future:{items:[]}},_createButton:function(t,e,i,o){var s=this.options[t+"Text"]||"",n=this.options[t+"Image"]||"",r=this.options[t+"Tooltip"]||"",a=L.DomUtil.create("a","history-"+t+"-button",e);if(n){var u='<i class="'+n+'"></i>';this.options[t+"ImageBeforeText"]?s=u+" "+s:s+=" "+u}a.innerHTML=s,a.href="#",a.title=r;var h=L.DomEvent.stopPropagation;return L.DomEvent.on(a,"click",h).on(a,"mousedown",h).on(a,"dblclick",h).on(a,"click",L.DomEvent.preventDefault).on(a,"click",i,o).on(a,"click",this._refocusOnMap,o),a},_updateDisabled:function(){var t=0===this._state.history.items.length,e=0===this._state.future.items.length;t!==this._state.backDisabled&&(this._state.backDisabled=t,this._map.fire("historyback"+(t?"disabled":"enabled"))),e!==this._state.forwardDisabled&&(this._state.forwardDisabled=e,this._map.fire("historyforward"+(e?"disabled":"enabled"))),this.options.useExternalControls||(this._setButtonDisabled(this._backButton,t),this._setButtonDisabled(this._forwardButton,e))},_setButtonDisabled:function(t,e){var i=$(t),o="leaflet-disabled";e?i.addClass(o):i.removeClass(o)},_pop:function(t){return t=t.items,$.isArray(t)&&t.length>0?t.splice(t.length-1,1)[0]:void 0},_push:function(t,e){var i=this._state.maxMovesToSave;t=t.items,$.isArray(t)&&(t.push(e),i>0&&t.length>i&&t.splice(0,1))},_invokeBackOrForward:function(t,e,i){var o=this._popStackAndUseLocation(e,i);return o?(this._map.fire(t,o),!0):!1},_popStackAndUseLocation:function(t,e){if($.isArray(t.items)&&t.items.length>0){var i=this._buildZoomCenterObjectFromCurrent(this._map),o=this._pop(t);return this._push(e,i),this.moveWithoutTriggeringEvent(o),{previousLocation:o,currentLocation:i}}},_buildZoomCenterObjectFromCurrent:function(t){return new L.ZoomCenter(t.getZoom(),t.getCenter())},_addMapListeners:function(){var t=this;this._map.on("movestart",function(e){if(!t._state.ignoringEvents){var i=t._buildZoomCenterObjectFromCurrent(e.target);t.options.shouldSaveMoveInHistory(i)&&(t._state.future.items=[],t._push(t._state.history,i))}t._updateDisabled()})}})}(),function(){L.ZoomCenter=L.Class.extend({initialize:function(t,e){this.zoom=t,this.centerPoint=e}})}();
